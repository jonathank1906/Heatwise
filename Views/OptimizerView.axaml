<UserControl
    x:Class="Sem2Proj.Views.OptimizerView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ScottPlot="clr-namespace:ScottPlot.Avalonia;assembly=ScottPlot.Avalonia"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:Sem2Proj.ViewModels"
    d:DesignHeight="450"
    d:DesignWidth="800"
    x:DataType="vm:OptimizerViewModel"
    Background="#1e1e1e"
    mc:Ignorable="d">

    <Design.DataContext>
        <vm:OptimizerViewModel />
    </Design.DataContext>

    <UserControl.Styles>
        <!--  Fancy RadioButton Style with circle indicator  -->
        <Style Selector="RadioButton.fancy">
            <Setter Property="Background" Value="#2d2d2d" />
            <Setter Property="BorderBrush" Value="#3e3e3e" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Margin" Value="0,5" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="10,8,15,8" />
            <Setter Property="MinWidth" Value="120" />
            <Setter Property="Template">
                <ControlTemplate>
                    <Border
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="{TemplateBinding CornerRadius}">
                        <DockPanel>
                            <!--  Radio button circle  -->
                            <Border
                                Width="20"
                                Height="20"
                                Margin="5,0,10,0"
                                VerticalAlignment="Center"
                                DockPanel.Dock="Left">
                                <Ellipse
                                    x:Name="radioMark"
                                    Width="16"
                                    Height="16"
                                    Fill="Transparent"
                                    Stroke="#7e7e7e"
                                    StrokeThickness="2" />
                            </Border>
                            <!--  Content  -->
                            <ContentPresenter VerticalAlignment="Center" Content="{TemplateBinding Content}" />
                        </DockPanel>
                    </Border>
                </ControlTemplate>
            </Setter>
        </Style>

        <Style Selector="RadioButton.fancy:pointerover">
            <Setter Property="Background" Value="#3a3a3a" />
            <Setter Property="BorderBrush" Value="#4e4e4e" />
        </Style>

        <Style Selector="RadioButton.fancy:checked">
            <Setter Property="Background" Value="#1a3a5a" />
            <!--  Darker blue background  -->
            <Setter Property="BorderBrush" Value="#0078d7" />
        </Style>

        <!--  Style for the checked radio mark  -->
        <Style Selector="RadioButton.fancy:checked /template/ Ellipse#radioMark">
            <Setter Property="Fill" Value="#0078d7" />
            <Setter Property="Stroke" Value="#005a9e" />
        </Style>
    </UserControl.Styles>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  Open Button (identical to SourceDataManagerView)  -->
        <Button
            Grid.Column="0"
            Width="30"
            Height="30"
            Margin="5"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Command="{Binding TriggerPaneCommand}"
            IsVisible="{Binding !IsPaneOpen}">
            <Button.Styles>
                <Style Selector="Button">
                    <Setter Property="Panel.ZIndex" Value="0" />
                </Style>
            </Button.Styles>
            <PathIcon Data="{StaticResource RightArrow}" />
        </Button>

        <!--  Side Panel (identical structure to SourceDataManagerView)  -->
        <Border
            Grid.Column="0"
            Width="{Binding PaneWidth}"
            Background="#252526"
            BorderBrush="LightGray"
            ClipToBounds="True"
            Tag="{Binding IsPaneOpen}">
            <Border.Styles>
                <Style Selector="Border">
                    <Setter Property="Panel.ZIndex" Value="1" />
                </Style>
                <Style Selector="Border[Tag=True]">
                    <Setter Property="Transitions">
                        <Transitions>
                            <DoubleTransition
                                Easing="BackEaseOut"
                                Property="Width"
                                Duration="0:0:0.3" />
                        </Transitions>
                    </Setter>
                </Style>
                <Style Selector="Border[Tag=False]">
                    <Setter Property="Transitions">
                        <Transitions>
                            <DoubleTransition
                                Easing="BackEaseIn"
                                Property="Width"
                                Duration="0:0:0.3" />
                        </Transitions>
                    </Setter>
                </Style>
            </Border.Styles>

            <Grid>
                <StackPanel
                    Margin="0,50,0,0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Top"
                    Spacing="10">

                    <TextBlock FontSize="18" Text="Preset" />
                    <RadioButton
                        Classes="fancy"
                        Content="Scenario 1"
                        GroupName="ScenarioGroup"
                        IsChecked="{Binding IsScenario1Selected}" />
                    <RadioButton
                        Classes="fancy"
                        Content="Scenario 2"
                        GroupName="ScenarioGroup"
                        IsChecked="{Binding IsScenario2Selected}" />

                    <TextBlock FontSize="18" Text="Optimization Period" />
                    <RadioButton
                        Classes="fancy"
                        Content="Summer"
                        GroupName="SeasonGroup"
                        IsChecked="{Binding IsSummerSelected}" />
                    <RadioButton
                        Classes="fancy"
                        Content="Winter"
                        GroupName="SeasonGroup"
                        IsChecked="{Binding IsWinterSelected}" />

                    <TextBlock FontSize="16" Text="Optimization Preference" />
                    <RadioButton
                        Classes="fancy"
                        Content="Cost"
                        GroupName="OptimizationGroup"
                        IsChecked="{Binding IsCostSelected}" />
                    <RadioButton
                        Classes="fancy"
                        Content="CO2"
                        GroupName="OptimizationGroup"
                        IsChecked="{Binding IsCO2Selected}" />

                    <TextBlock FontSize="18" Text="Date Range" />
                    <Calendar
                        Name="OptimizationCalendar"
                        Background="#2d2d2d"
                        BorderBrush="#3e3e3e"
                        BorderThickness="5,5,5,5"
                        CornerRadius="15,15,15,15"
                        Foreground="White"
                        SelectionMode="MultipleRange" />

                    <StackPanel
                        HorizontalAlignment="Center"
                        Orientation="Horizontal"
                        Spacing="10">
                        <Button
                            Width="100"
                            Click="SetRange_Click"
                            Content="Set Range" />
                    </StackPanel>

                    <Button
                        Width="110"
                        Height="50"
                        HorizontalAlignment="Center"
                        Classes="FancyGreenButton"
                        Command="{Binding OptimizeAndPlotCommand}"
                        Content="Optimize" />
                </StackPanel>

                <Button
                    Grid.Column="0"
                    Width="30"
                    Height="30"
                    Margin="0,5,5,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Command="{Binding TriggerPaneCommand}"
                    IsVisible="{Binding IsPaneOpen}">
                    <PathIcon Data="{StaticResource LeftArrow}" />
                </Button>
            </Grid>
        </Border>

        <!--  Main Content Area  -->
        <Border Grid.Column="1" Background="#1e1e1e">
            <Grid>
                <CheckBox
                    Margin="10,5"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Content="Show Heat Demand"
                    IsChecked="{Binding ShowHeatDemand}" />
                <Button
                    Margin="5"
                    HorizontalAlignment="Right"
                    Click="ToggleTooltip_Click"
                    Content="Toggle Tooltip" />

                <StackPanel
                    Grid.Row="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                    <TextBlock
                        FontSize="18"
                        Foreground="White"
                        IsVisible="{Binding !HasOptimized}"
                        Text="Click Optimize to get started" />

                    <Grid>
                        <ScottPlot:AvaPlot
                            x:Name="OptimizationPlot"
                            Width="1500"
                            Height="900"
                            IsVisible="{Binding HasOptimized}" />

                        <!--  Reset View Button  -->
                        <Button
                            x:Name="ResetViewButton"
                            Width="30"
                            Height="30"
                            Margin="0,18,15,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Background="Transparent"
                            Command="{Binding ResetViewCommand}"
                            IsVisible="{Binding HasOptimized}">
                            <PathIcon
                                Width="20"
                                Height="20"
                                Data="{StaticResource Home}" />
                        </Button>
                    </Grid>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
